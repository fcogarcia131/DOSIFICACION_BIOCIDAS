<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Dosis Profesional</title>
<style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
    .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); width: 100%; max-width: 450px; }
    h2 { text-align: center; color: #333; font-size: 1.4rem; margin-bottom: 20px; }
    label { font-weight: 600; display: block; margin-top: 12px; color: #555; }
    select, input { width: 100%; padding: 12px; margin-top: 5px; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box; font-size: 15px; }
    button { width: 100%; padding: 14px; border: none; border-radius: 8px; background-color: #007bff; color: white; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 15px; transition: 0.3s; }
    button:hover { background-color: #0056b3; }
    .btn-ins { background-color: #28a745; }
    .btn-ins:hover { background-color: #1e7e34; }
    .btn-vec { background-color: #17a2b8; }
    .btn-vec:hover { background-color: #138496; }
    .btn-volver { background-color: #6c757d; margin-top: 10px; }
    .resultado { margin-top: 20px; padding: 15px; background-color: #f0fff4; border-left: 5px solid #28a745; border-radius: 8px; color: #155724; }
    .operacion { font-family: 'Courier New', Courier, monospace; background: #e8f0fe; padding: 10px; border-radius: 5px; font-size: 0.85rem; color: #333; margin-top: 10px; border: 1px solid #d1d9e6; }
    small { color: #666; display: block; margin-top: 5px; }
</style>
</head>
<body>

<div class="container">
    <div id="menu">
        <h2>Calculadora de Dosis</h2>
        <button onclick="ver('agua')">Biocidas (PPM)</button>
        <button class="btn-ins" onclick="ver('ins')">Insecticidas (%)</button>
        <button class="btn-vec" onclick="ver('vec')">Vectobac 12AS (Dual)</button>
    </div>

    <div id="sec-agua" style="display:none;">
        <h2>Biocidas (PPM)</h2>
        <label>Producto:</label>
        <select id="agua_bio">
            <option value="576000">Peróxido Hidrógeno 48% - 576000 ppm</option>
            <option value="187500">Hipoclorito Sódico 15% - 187500 ppm</option>
            <option value="162500">Hipoclorito Sódico 13% - 162500 ppm</option>
            <option value="300000">Peróxido Hidrógeno 25% - 300000 ppm</option>
        </select>
        <label>Dosis deseada (ppm):</label> <input type="number" id="agua_dosis" placeholder="Ej: 50">
        <label>Volumen Sistema (L):</label> <input type="number" id="agua_vol" placeholder="Ej: 1000">
        <button onclick="calcAgua()">Calcular</button>
        <button class="btn-volver" onclick="irMenu()">Volver</button>
    </div>

    <div id="sec-ins" style="display:none;">
        <h2>Insecticidas (%)</h2>
        <label>Conc. envase (%):</label> <input type="number" id="ins_conc" placeholder="Ej: 10">
        <label>Dosis deseada (%):</label> <input type="number" id="ins_dosis" placeholder="Ej: 0.5">
        <label>Volumen caldo (L):</label> <input type="number" id="ins_vol" placeholder="Ej: 5">
        <button class="btn-ins" onclick="calcIns()">Calcular Mezcla</button>
        <button class="btn-volver" onclick="irMenu()">Volver</button>
    </div>

    <div id="sec-vec" style="display:none;">
        <h2>Vectobac 12AS</h2>
        <label>Tipo de Aplicación:</label>
        <select id="v_tipo" onchange="toggleVectobac()">
            <option value="imbornales">Imbornales (Mochila 5L)</option>
            <option value="superficie">Grandes Superficies (m²)</option>
        </select>
        <div id="div_superficie" style="display:none;">
            <label>Superficie total (m²):</label>
            <input type="number" id="v_m2" placeholder="Ej: 5000">
        </div>
        <label>Infestación:</label>
        <select id="v_inf">
            <option value="0.5">Baja (0.5 L/ha)</option>
            <option value="2.5">Alta (2.5 L/ha)</option>
        </select>
        <label>¿Larvas L3-L4?</label>
        <select id="v_lar">
            <option value="0">No</option>
            <option value="0.5">Sí (+0.5 L/ha)</option>
        </select>
        <label>Carga orgánica:</label>
        <select id="v_org">
            <option value="0">Baja</option>
            <option value="0.5">Alta (+0.5 L/ha)</option>
        </select>
        <button class="btn-vec" onclick="calcVec()">Calcular Dosis</button>
        <button class="btn-volver" onclick="irMenu()">Volver</button>
    </div>

    <div id="resultado" class="resultado" style="display:none;"></div>
</div>

<script>
    function ver(id) {
        document.getElementById('menu').style.display = 'none';
        document.querySelectorAll('[id^="sec-"]').forEach(s => s.style.display = 'none');
        document.getElementById('sec-' + id).style.display = 'block';
        if(id === 'vec') toggleVectobac();
    }

    function irMenu() {
        document.getElementById('menu').style.display = 'block';
        document.querySelectorAll('[id^="sec-"]').forEach(s => s.style.display = 'none');
        document.getElementById('resultado').style.display = 'none';
    }

    function toggleVectobac() {
        const tipo = document.getElementById('v_tipo').value;
        document.getElementById('div_superficie').style.display = tipo === 'superficie' ? 'block' : 'none';
    }

    function mostrarResFinal(resHTML, opHTML) {
        const resDiv = document.getElementById("resultado");
        resDiv.style.display = "block";
        resDiv.innerHTML = resHTML + `<div class="operacion"><strong>Operación:</strong><br>${opHTML}</div>`;
    }

    function calcAgua() {
        const conc = parseFloat(document.getElementById("agua_bio").value);
        const dosis = parseFloat(document.getElementById("agua_dosis").value);
        const vol = parseFloat(document.getElementById("agua_vol").value);
        if (isNaN(dosis) || isNaN(vol)) return alert("Complete campos");
        
        const resultadoL = (dosis * vol) / conc;
        const op = `(${dosis} ppm * ${vol} L) / ${conc} ppm = ${resultadoL.toFixed(4)} L`;
        mostrarResFinal(`Añadir: ${resultadoL.toFixed(4)} L (${(resultadoL*1000).toFixed(2)} mL)`, op);
    }

    function calcIns() {
        const conc = parseFloat(document.getElementById("ins_conc").value);
        const dosis = parseFloat(document.getElementById("ins_dosis").value);
        const vol = parseFloat(document.getElementById("ins_vol").value);
        if (isNaN(conc) || isNaN(dosis) || isNaN(vol)) return alert("Complete campos");

        const resultadoL = (dosis * vol) / conc;
        const op = `(${dosis}% * ${vol} L) / ${conc}% = ${resultadoL.toFixed(4)} L`;
        mostrarResFinal(`Añadir: ${resultadoL.toFixed(4)} L (${(resultadoL*1000).toFixed(2)} mL)`, op);
    }

    function calcVec() {
        let dosisLHa = parseFloat(document.getElementById("v_inf").value) + 
                       parseFloat(document.getElementById("v_lar").value) + 
                       parseFloat(document.getElementById("v_org").value);
        
        if(dosisLHa > 2.5) dosisLHa = 2.5;
        if(dosisLHa < 0.25) dosisLHa = 0.25;

        const tipo = document.getElementById('v_tipo').value;
        
        if (tipo === 'imbornales') {
            let btiPorImb = (dosisLHa / 10) * 0.5; // ml en 0.5m2
            let mlMochila = 5000 * (btiPorImb / 30);
            
            let op = `1. Dosis m²: (${dosisLHa} L/ha / 10) * 0.5m² = ${btiPorImb.toFixed(3)} ml BTI/imb.<br>` +
                     `2. Mochila: 5000 * (${btiPorImb.toFixed(3)} / 30 ml gasto) = ${mlMochila.toFixed(2)} ml`;
            
            mostrarResFinal(`Dosis: ${dosisLHa.toFixed(2)} L/ha<br>Mochila 5L: ${mlMochila.toFixed(2)} mL`, op);
        } else {
            const m2 = parseFloat(document.getElementById("v_m2").value);
            if (isNaN(m2)) return alert("Indique m²");
            let totalML = (dosisLHa * m2) / 10;
            
            let op = `(${dosisLHa} L/ha * ${m2} m²) / 10 = ${totalML.toFixed(1)} ml total`;
            mostrarResFinal(`Dosis: ${dosisLHa.toFixed(2)} L/ha<br>Producto: ${totalML.toFixed(1)} mL`, op);
        }
    }
</script>
</body>
</html>
