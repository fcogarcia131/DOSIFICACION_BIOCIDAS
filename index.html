function cargarVectobac() {
    document.getElementById("menu").style.display = "none";
    document.getElementById("contenido").style.display = "block";
    document.getElementById("contenido").innerHTML = `
        <h2>Vectobac 12 AS</h2>

        <label>Tipo de tratamiento:</label>
        <select id="tipoTratamiento" onchange="mostrarOpcionesVectobac()">
            <option value="superficie">Grandes superficies</option>
            <option value="imbornales">Imbornales municipales</option>
        </select>

        <div id="opcionesVectobac"></div>

        <button onclick="calcularVectobac()">Calcular</button>
        <button class="boton-volver" onclick="volverMenu()">Volver</button>
        <div id="resultado" class="resultado" style="display:none;"></div>
    `;

    mostrarOpcionesVectobac();
}

function mostrarOpcionesVectobac() {

    let tipo = document.getElementById("tipoTratamiento").value;
    let html = `
        <label>Nivel infestación:</label>
        <select id="nivel">
            <option value="baja">Baja</option>
            <option value="media">Media</option>
            <option value="alta">Alta</option>
        </select>

        <label>¿Alta carga orgánica?</label>
        <select id="organica">
            <option value="false">No</option>
            <option value="true">Sí</option>
        </select>
    `;

    if (tipo === "superficie") {
        html += `
            <label>Superficie (m²):</label>
            <input type="number" id="superficie">

            <label>Volumen aplicación (L/ha):</label>
            <select id="volHa">
                <option value="300">Lámina limpia (300 L/ha)</option>
                <option value="600">Vegetación media (600 L/ha)</option>
                <option value="900">Vegetación densa (900 L/ha)</option>
            </select>
        `;
    }

    document.getElementById("opcionesVectobac").innerHTML = html;
}

function calcularVectobac() {

    const tipo = document.getElementById("tipoTratamiento").value;
    const nivel = document.getElementById("nivel").value;
    const organica = document.getElementById("organica").value === "true";

    const rangos = {
        baja: 0.08,
        media: 0.125,
        alta: 0.175
    };

    let dosis = rangos[nivel];

    if (organica) dosis += 0.02;
    if (dosis > 0.25) dosis = 0.25;

    let resultado = document.getElementById("resultado");
    resultado.style.display = "block";

    /* ===========================
       GRANDES SUPERFICIES
    ============================ */
    if (tipo === "superficie") {

        const superficie = parseFloat(document.getElementById("superficie").value);
        const volHa = parseFloat(document.getElementById("volHa").value);

        if (isNaN(superficie)) {
            alert("Introduzca la superficie.");
            return;
        }

        const producto = superficie * dosis;
        const caldo = superficie * (volHa / 10000);
        const concentracion = producto / caldo;

        resultado.innerHTML = `
            <strong>GRANDES SUPERFICIES</strong><br><br>
            Dosis aplicada: ${dosis.toFixed(3)} ml/m²<br>
            Producto total: ${producto.toFixed(2)} ml<br>
            Caldo necesario: ${caldo.toFixed(2)} L<br>
            Concentración final: ${concentracion.toFixed(4)} ml/L
        `;
    }

    /* ===========================
       IMBORNALES
    ============================ */
    else {

        const superficieImbornal = 0.5; // m²
        const mochila = 5; // L
        const caldoPorImbornal = 0.5; // L asumido

        const productoPorImbornal = dosis * superficieImbornal;

        const imbornalesTratables = Math.floor(mochila / caldoPorImbornal);

        const productoTotal = productoPorImbornal * imbornalesTratables;

        resultado.innerHTML = `
            <strong>TRATAMIENTO EN IMBORNALES</strong><br><br>

            Dosis aplicada según etiqueta: ${dosis.toFixed(3)} ml/m²<br>
            Producto por imbornal: ${productoPorImbornal.toFixed(3)} ml<br><br>

            Producto a añadir a mochila (5 L): 
            <strong>${productoTotal.toFixed(2)} ml</strong><br><br>

            Imbornales tratables con 5 L: 
            <strong>${imbornalesTratables}</strong><br><br>

            <small>
            Cálculo basado en superficie estándar 0.5 m² por imbornal 
            y aplicación aproximada de 0.5 L de caldo por unidad.
            </small>
        `;
    }
}
