<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Dosis de Biocidas</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f6f8;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
    }
    .container {
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        width: 420px;
    }
    h2 { text-align: center; font-size: 1.3rem; margin-bottom: 20px; }
    label { font-weight: bold; display: block; margin-top: 10px; }
    select, input {
        width: 100%;
        padding: 10px;
        margin-top: 5px;
        margin-bottom: 10px;
        border-radius: 6px;
        border: 1px solid #ccc;
        box-sizing: border-box;
    }
    button {
        width: 100%;
        padding: 12px;
        border: none;
        border-radius: 6px;
        background-color: #007bff;
        color: white;
        font-size: 16px;
        cursor: pointer;
        margin-bottom: 10px;
    }
    button:hover { background-color: #0056b3; }
    .boton-vectobac { background-color: #28a745; }
    .boton-vectobac:hover { background-color: #218838; }
    .boton-volver { background-color: #6c757d; }
    .resultado {
        margin-top: 20px;
        padding: 15px;
        background-color: #e9f7ef;
        border-radius: 6px;
        font-weight: bold;
        text-align: center;
    }
    .info-sm { font-weight: normal; font-size: 0.85rem; color: #666; display: block; margin-bottom: 10px; }
</style>
</head>
<body>

<div class="container" id="main-container">
    <div id="menu">
        <h2>Calculadora de Biocidas</h2>
        <button onclick="mostrarSeccion('agua')">Desinfección de Agua</button>
        <button onclick="mostrarSeccion('insecticidas')">Insecticidas Genéricos</button>
        <button class="boton-vectobac" onclick="mostrarSeccion('vectobac')">Vectobac 12AS (Imbornales)</button>
    </div>

    <div id="sec-agua" style="display:none;">
        <h2>Desinfección de Agua</h2>
        <label>Seleccionar Biocida:</label>
        <select id="biocida_agua">
            <option value="576000">Peróxido Hidrógeno 48% (OX AGUA) - 576000 ppm</option>
            <option value="187500">Hipoclorito Sódico 15% - 187500 ppm</option>
            <option value="162500">Hipoclorito Sódico 13% - 162500 ppm</option>
            <option value="300000">Peróxido Hidrógeno 25% (OX AIRE TORRES) - 300000 ppm</option>
        </select>
        <label>Concentración Deseada (ppm):</label>
        <input type="number" id="dosis_agua" placeholder="Ej: 50">
        <label>Volumen del Sistema (L):</label>
        <input type="number" id="vol_agua" placeholder="Ej: 1000">
        <button onclick="calcularAgua()">Calcular</button>
        <button class="boton-volver" onclick="irMenu()">Volver</button>
    </div>

    <div id="sec-vectobac" style="display:none;">
        <h2>Vectobac 12AS (Imbornales)</h2>
        <span class="info-sm">Cálculo para imbornal de 0.5m² y pulverización de 3 seg.</span>
        
        <label>Nivel de infestación:</label>
        <select id="v_infest">
            <option value="0.5">Baja (0.5 L/ha)</option>
            <option value="1.5">Alta (1.5 L/ha)</option>
        </select>

        <label>Predominio L3-L4:</label>
        <select id="v_larvas">
            <option value="0">No</option>
            <option value="0.5">Sí (+0.5 L/ha)</option>
        </select>

        <label>Carga orgánica:</label>
        <select id="v_organica">
            <option value="0">Baja</option>
            <option value="0.5">Alta (+0.5 L/ha)</option>
        </select>

        <button class="boton-vectobac" onclick="calcularVectobac()">Calcular para Mochila 5L</button>
        <button class="boton-volver" onclick="irMenu()">Volver</button>
    </div>

    <div id="sec-ins" style="display:none;">
        <h2>Insecticidas</h2>
        <label>Dosis deseada (%):</label>
        <input type="number" id="ins_dosis" placeholder="Ej: 1">
        <label>Volumen Caldo (L):</label>
        <input type="number" id="ins_vol" placeholder="Ej: 5">
        <button onclick="calcularIns()">Calcular</button>
        <button class="boton-volver" onclick="irMenu()">Volver</button>
    </div>

    <div id="resultado" class="resultado" style="display:none;"></div>
</div>

<script>
    const CAUDAL_SEG = 10; // 10ml/seg (600ml/min)
    const TIEMPO_SP = 3;   // segundos
    const VOL_MOCHILA = 5000; // ml
    const SUP_IMB = 0.5; // m2

    function mostrarSeccion(id) {
        document.getElementById('menu').style.display = 'none';
        document.getElementById('sec-agua').style.display = id === 'agua' ? 'block' : 'none';
        document.getElementById('sec-vectobac').style.display = id === 'vectobac' ? 'block' : 'none';
        document.getElementById('sec-ins').style.display = id === 'insecticidas' ? 'block' : 'none';
        document.getElementById('resultado').style.display = 'none';
    }

    function irMenu() {
        document.getElementById('menu').style.display = 'block';
        document.getElementById('sec-agua').style.display = 'none';
        document.getElementById('sec-vectobac').style.display = 'none';
        document.getElementById('sec-ins').style.display = 'none';
        document.getElementById('resultado').style.display = 'none';
    }

    function calcularAgua() {
        const concentracion = parseFloat(document.getElementById("biocida_agua").value);
        const dosis = parseFloat(document.getElementById("dosis_agua").value);
        const volumen = parseFloat(document.getElementById("vol_agua").value);

        if (isNaN(dosis) || isNaN(volumen)) return alert("Complete los campos");

        const volL = (dosis * volumen) / concentracion;
        mostrarResultado(volL);
    }

    function calcularVectobac() {
        // 1. Dosis según criterios (L/ha)
        let dosisLHa = parseFloat(document.getElementById("v_infest").value) + 
                       parseFloat(document.getElementById("v_larvas").value) + 
                       parseFloat(document.getElementById("v_organica").value);
        
        // Ajuste límites etiqueta (0.25 - 2.5)
        dosisLHa = Math.min(Math.max(dosisLHa, 0.25), 2.5);

        // 2. Cantidad BTI por imbornal (ml de producto en 0.5m2)
        // (Dosis L/ha / 10000m2) * 1000ml/L * 0.5m2 = dosisLHa / 20
        let cantBtiImbornal = (dosisLHa / 10) * SUP_IMB;

        // 3. Tu fórmula: 5000 * ( CANTIDAD BTI imbornal / (CAUDAL ml/seg * 3 seg) )
        let mlMochila = VOL_MOCHILA * (cantBtiImbornal / (CAUDAL_SEG * TIEMPO_SP));
        
        let imbornalesPosibles = Math.floor(VOL_MOCHILA / (CAUDAL_SEG * TIEMPO_SP));

        const res = document.getElementById("resultado");
        res.style.display = "block";
        res.innerHTML = `Dosis: ${dosisLHa.toFixed(2)} L/ha<br><br>` +
                        `Añadir a mochila 5L:<br>${mlMochila.toFixed(2)} mL de Vectobac 12AS<br><br>` +
                        `Se pueden tratar: ${imbornalesPosibles} imbornales`;
    }

    function calcularIns() {
        const d = parseFloat(document.getElementById("ins_dosis").value);
        const v = parseFloat(document.getElementById("ins_vol").value);
        if (isNaN(d) || isNaN(v)) return alert("Complete los campos");
        const ml = (d * v * 1000) / 100;
        mostrarResultado(ml / 1000);
    }

    function mostrarResultado(litros) {
        const res = document.getElementById("resultado");
        res.style.display = "block";
        res.innerHTML = `Volumen a añadir:<br><br>${litros.toFixed(4)} L<br>${(litros * 1000).toFixed(2)} mL`;
    }
</script>

</body>
</html>
