<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Vectobac 12AS</title>

<style>
body {
    font-family: Arial, sans-serif;
    background-color: #f4f6f8;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
}

.container {
    background: white;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    width: 100%;
    max-width: 520px;
}

h2 { text-align: center; color: #333; margin-bottom: 20px; }

label { font-weight: bold; display: block; margin-top: 10px; }

select, input {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    margin-bottom: 15px;
    border-radius: 6px;
    border: 1px solid #ccc;
    box-sizing: border-box;
}

button {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 6px;
    background-color: #17a2b8;
    color: white;
    font-size: 16px;
    cursor: pointer;
    margin-top: 10px;
}

button:hover { background-color: #117a8b; }

.btn-volver { background-color: #007bff; }

.resultado {
    margin-top: 20px;
    padding: 15px;
    background-color: #e9f7ef;
    border-radius: 6px;
    border-left: 4px solid #28a745;
}

.operacion {
    font-family: 'Courier New', monospace;
    background: #e8f0fe;
    padding: 12px;
    border-radius: 5px;
    font-size: 0.82rem;
    color: #333;
    margin-top: 15px;
    border: 1px solid #d1d9e6;
    line-height: 1.6;
}

.criterio-box {
    margin-top: 15px;
    padding: 12px;
    background: #fff3cd;
    border: 1px solid #ffeeba;
    border-radius: 6px;
    font-size: 0.8rem;
    color: #856404;
}

hr { border: 0; border-top: 1px solid #c3e6cb; margin: 15px 0; }

#div_superficie { display: none; }
</style>
</head>

<body>

<div class="container">

<h2>ü¶ü Vectobac 12AS</h2>

<label>Tipo de Aplicaci√≥n:</label>
<select id="v_tipo" onchange="toggleVectobac()">
    <option value="imbornales">Tratamiento de Imbornales (Mochila 5L)</option>
    <option value="masas_agua">Tratamiento de Grandes Masas de Agua (m¬≤)</option>
</select>

<div id="div_superficie">
    <label>Superficie total (m¬≤):</label>
    <input type="number" id="v_m2" value="2000">
</div>

<label>Nivel de infestaci√≥n:</label>
<select id="v_inf">
    <option value="0.5">Baja (0.5 L/ha)</option>
    <option value="1.5" selected>Intermedia (1.5 L/ha)</option>
    <option value="2.5">Alta (2.5 L/ha)</option>
</select>

<label>¬øLarvas L3-L4?</label>
<select id="v_lar">
    <option value="0">No</option>
    <option value="0.5">S√≠ (+0.5 L/ha)</option>
</select>

<label>Carga org√°nica / Vegetaci√≥n:</label>
<select id="v_condicion">
    <option value="300">L√°mina limpia (300 L/ha)</option>
    <option value="550" selected>Vegetaci√≥n media (550 L/ha)</option>
    <option value="850">Vegetaci√≥n densa / Carga org√°nica alta (850 L/ha)</option>
</select>

<button onclick="calcVec()">Calcular Dosis y Rendimiento</button>

<a href="index.html">
    <button class="btn-volver">
        ‚¨Ö Volver al Men√∫ Principal
    </button>
</a>

<div id="resultado" class="resultado" style="display:none;"></div>

</div>

<script>
// Constantes para Vectobac
const VOL_MOCHILA_ML = 5000;
const CAUDAL_SEG = 10;
const TIEMPO_PULV = 3;
const GASTO_IMB = CAUDAL_SEG * TIEMPO_PULV;
const SUPERFICIE_IMBORNAL = 0.5;

function toggleVectobac() {
    const tipo = document.getElementById('v_tipo').value;
    const divSuperficie = document.getElementById('div_superficie');
    
    // Mostrar superficie SOLO para grandes masas de agua
    if (divSuperficie) {
        divSuperficie.style.display = tipo === 'masas_agua' ? 'block' : 'none';
    }
}

function calcVec() {
    const vInf = document.getElementById("v_inf");
    const vLar = document.getElementById("v_lar");
    const vCondicion = document.getElementById("v_condicion");
    const vTipo = document.getElementById('v_tipo');
    const vM2 = document.getElementById("v_m2");
    const resDiv = document.getElementById("resultado");

    if (!vInf || !vLar || !vTipo || !resDiv) {
        alert("‚ö†Ô∏è Error: Elementos del formulario no encontrados. Recargue la p√°gina.");
        return;
    }

    let dosisLHa = parseFloat(vInf.value) + parseFloat(vLar.value);
    if (dosisLHa > 2.5) dosisLHa = 2.5;

    const volCaldoHa = parseFloat(vCondicion.value);
    const tipo = vTipo.value;
    resDiv.style.display = "block";

    if (tipo === 'imbornales') {
        // ============================================
        // C√ÅLCULOS PARA IMBORNALES
        // NO se usa el volumen por hect√°rea (v_condicion)
        // Se basa en: tiempo (3 seg) + caudal (10 ml/seg) = 30 ml/imbornal
        // ============================================
        
        const btiPorM2 = dosisLHa / 10000; // L/m¬≤
        const btiPorM2_ml = btiPorM2 * 1000; // mL/m¬≤
        const btiPorImb = btiPorM2_ml * SUPERFICIE_IMBORNAL; // mL por imbornal (0.5 m¬≤)
        
        const caldoPorImb = GASTO_IMB; // 30 ml (fijo, no depende de L/ha)
        const proporcion = btiPorImb / caldoPorImb;
        const mlBtiMochila = VOL_MOCHILA_ML * proporcion;
        const totalImbornales = Math.floor(VOL_MOCHILA_ML / caldoPorImb);

        resDiv.innerHTML = `
            <strong>üìä Dosis calculada:</strong> ${dosisLHa.toFixed(2)} L/ha<hr>
            
            <strong>üéí Para Mochila Goizper IK 5L:</strong><br>
            ‚Ä¢ Vectobac 12AS: <b>${mlBtiMochila.toFixed(2)} mL</b><br>
            ‚Ä¢ Agua: completar hasta 5 litros<br><br>
            
            <strong>‚úÖ PAR√ÅMETROS DE APLICACI√ìN:</strong><br>
            ‚Ä¢ üìê <b>Superficie/imbornal: ${SUPERFICIE_IMBORNAL} m¬≤</b><br>
            ‚Ä¢ ‚è±Ô∏è <b>Tiempo de aplicaci√≥n: ${TIEMPO_PULV} segundos</b><br>
            ‚Ä¢ üíß <b>Caldo aplicado: ${caldoPorImb} mL/imbornal</b><br>
            ‚Ä¢ üéØ <b>Dosis BTI: ${btiPorImb.toFixed(3)} mL/imbornal</b><br>
            ‚Ä¢ üì¶ <b>Rendimiento: ${totalImbornales} imbornales por carga</b>
            
            <div class="operacion">
                <strong>üìê C√ÅLCULOS MATEM√ÅTICOS (IMBORNALES):</strong><br><br>
                
                <strong>1. Dosis total (L/ha):</strong><br>
                ${vInf.options[vInf.selectedIndex].text.split('(')[0].trim()} + ${vLar.options[vLar.selectedIndex].text.includes('S√≠') ? '0.5 L/ha' : '0 L/ha'}<br>
                = ${parseFloat(vInf.value)} + ${parseFloat(vLar.value)} = <b>${dosisLHa.toFixed(2)} L/ha</b><br><br>
                
                <strong>2. Conversi√≥n a mL/m¬≤:</strong><br>
                ${dosisLHa.toFixed(2)} L/ha √∑ 10.000 m¬≤/ha √ó 1000 mL/L<br>
                = ${(dosisLHa / 10).toFixed(4)} mL/m¬≤<br><br>
                
                <strong>3. BTI por imbornal (mL):</strong><br>
                ${(dosisLHa / 10).toFixed(4)} mL/m¬≤ √ó ${SUPERFICIE_IMBORNAL} m¬≤<br>
                = <b>${btiPorImb.toFixed(3)} mL</b><br><br>
                
                <strong>4. Caldo aplicado por imbornal (FIJO):</strong><br>
                ${CAUDAL_SEG} mL/seg √ó ${TIEMPO_PULV} seg = <b>${caldoPorImb} mL</b><br>
                <em>‚ö†Ô∏è No depende del volumen L/ha de carga org√°nica</em><br><br>
                
                <strong>5. Proporci√≥n BTI en el caldo:</strong><br>
                ${btiPorImb.toFixed(3)} mL BTI √∑ ${caldoPorImb} mL caldo = <b>${proporcion.toFixed(4)}</b><br><br>
                
                <strong>6. Vectobac para mochila 5L:</strong><br>
                ${VOL_MOCHILA_ML} mL √ó ${proporcion.toFixed(4)} = <b>${mlBtiMochila.toFixed(2)} mL</b><br><br>
                
                <strong>7. Rendimiento (imbornales por carga):</strong><br>
                ${VOL_MOCHILA_ML} mL √∑ ${caldoPorImb} mL/imbornal = <b>${totalImbornales} imbornales</b>
            </div>
            
            <div class="criterio-box">
                ‚ö†Ô∏è <strong>Notas t√©cnicas:</strong><br>
                ‚Ä¢ Superficie de 0.5 m¬≤ es estimaci√≥n est√°ndar para imbornales tipo sumidero.<br>
                ‚Ä¢ Tiempo de ${TIEMPO_PULV} segundos es cr√≠tico para la dosis correcta.<br>
                ‚Ä¢ El volumen de caldo (30 mL) es fijo por imbornal, no var√≠a con carga org√°nica.<br>
                ‚Ä¢ Usar cron√≥metro para garantizar precisi√≥n en cada punto.
            </div>
        `;
    } else {
        // ============================================
        // C√ÅLCULOS PARA GRANDES MASAS DE AGUA
        // S√ç se usa el volumen por hect√°rea (v_condicion)
        // ============================================
        
        const m2 = parseFloat(vM2.value);
        
        if (isNaN(m2) || m2 <= 0) {
            alert("‚ö†Ô∏è Indique una superficie v√°lida en m¬≤");
            return;
        }
        
        const btiTotalML = (dosisLHa * m2) / 10;
        const caldoTotalL = (volCaldoHa * m2) / 10000;
        const cargasNecesarias = Math.ceil(caldoTotalL / 5);

        resDiv.innerHTML = `
            <strong>üìê Superficie:</strong> ${m2.toLocaleString()} m¬≤<hr>
            
            <strong>‚úÖ RESULTADO:</strong><br>
            ‚Ä¢ Vectobac 12AS necesario: <b>${btiTotalML.toFixed(1)} mL</b><br>
            ‚Ä¢ Caldo total a preparar: <b>${caldoTotalL.toFixed(2)} L</b><br>
            ‚Ä¢ Cargas de mochila (5L): <b>${cargasNecesarias}</b>
            
            <div class="operacion">
                <strong>üìê C√ÅLCULOS MATEM√ÅTICOS (GRANDES MASAS DE AGUA):</strong><br><br>
                
                <strong>1. Dosis total (L/ha):</strong><br>
                = <b>${dosisLHa.toFixed(2)} L/ha</b><br><br>
                
                <strong>2. Vectobac 12AS necesario (mL):</strong><br>
                (${dosisLHa.toFixed(2)} L/ha √ó ${m2.toLocaleString()} m¬≤) √∑ 10<br>
                = ${btiTotalML.toFixed(1)} mL<br><br>
                
                <strong>3. Caldo total necesario (L):</strong><br>
                (${volCaldoHa} L/ha √ó ${m2.toLocaleString()} m¬≤) √∑ 10.000<br>
                = <b>${caldoTotalL.toFixed(2)} L</b><br>
                <em>‚úì Aqu√≠ S√ç se usa el volumen seg√∫n carga org√°nica</em><br><br>
                
                <strong>4. Cargas de mochila necesarias:</strong><br>
                ${caldoTotalL.toFixed(2)} L √∑ 5 L/mochila = ${cargasNecesarias} carga(s)
            </div>
            
            <div class="criterio-box">
                üìö <strong>Criterio t√©cnico:</strong><br>
                Dosis: ${dosisLHa.toFixed(2)} L/ha | Caldo: ${volCaldoHa} L/ha<br>
                Superficie total: ${m2.toLocaleString()} m¬≤ = ${(m2/10000).toFixed(2)} ha
            </div>
        `;
    }
}

// Inicializar al cargar
document.addEventListener('DOMContentLoaded', function() {
    toggleVectobac();
});
</script>

</body>
</html>
